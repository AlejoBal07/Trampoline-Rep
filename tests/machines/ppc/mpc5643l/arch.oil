/**
 * @file arch.oil
 *
 * @section desc File description
 *
 * Trampoline Test Suite : Machine dependant oil configuration
 *
 * @section copyright Copyright
 *
 * Trampoline Test Suite
 *
 */

#include "../../common/arch.oil"

IMPLEMENTATION archMpc5643l
{
  TASK
  {
    UINT32 STACKSIZE = 800;
  };

  ISR
  {
    UINT32 STACKSIZE = 800;
  };

  COUNTER
  {
    IDENTIFIER SOURCE = pit_ch0;
    UINT32  FREQUENCY = 120000;
  };
};

CPU archMpc5643lGcc
{
  OS defaultOS {
    /* Build paths are from the test directory */
    BUILD = TRUE
    {
      COMPILER = "powerpc-eabivle-gcc";
      ASSEMBLER = "powerpc-eabivle-as";
      LINKER = "powerpc-eabivle-ld";
      CFLAGS = "-Os";
      LDFLAGS = "-Map=build.map";
      LDFLAGS = "-L../../lib -lembUnit";
      SYSTEM = PYTHON;
      LIBRARY = archConfig;
    };

    MEMMAP = TRUE {
      COMPILER = gcc;
      LINKER = gnu_ld { SCRIPT = "script.ld"; };
      ASSEMBLER = gnu_as;
      MEMORY_PROTECTION = FALSE;
    };

    SYSTEM_CALL = TRUE;
    USEVLE = TRUE;
    DEBUG = TRUE;
    WITHORTI = TRUE {FILE = "trampoline.orti";};
  };

  /* Lib paths are from the "TRAMPOLINE/machines" directory */
  LIBRARY archConfig
  {
    PATH = "../tests/machines/ppc/mpc5643l/";
    CHEADER = "archTestConfig.h";
    CFILE = "archTestConfig.c";
  };
};