//---------------------------------------------------------------------------*
//                                                                           *
//                      File 'template_invocation.cpp'                       *
//                        Generated by version 2.5.4                         *
//                     january 16th, 2014, at 12h13'3"                       *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

#include "template_invocation.h"
#include "galgas2/C_Compiler.h"
#include "galgas2/C_galgas_io.h"
#include "galgas2/C_galgas_CLI_Options.h"
#include "utilities/C_PrologueEpilogue.h"

//---------------------------------------------------------------------------*

#include "goil_options.h"
#include "template_grammar.h"

//---------------------------------------------------------------------------*

#ifndef DO_NOT_GENERATE_CHECKINGS
  #define SOURCE_FILE_AT_LINE(line) "template_invocation.gSemantics", line
  #define COMMA_SOURCE_FILE_AT_LINE(line) , SOURCE_FILE_AT_LINE(line)
#else
  #define SOURCE_FILE_AT_LINE(line) 
  #define COMMA_SOURCE_FILE_AT_LINE(line) 
#endif

//---------------------------------------------------------------------------*
//                                                                           *
//                     Once function 'allowedFunctions'                      *
//                                                                           *
//---------------------------------------------------------------------------*

static GALGAS_stringset onceFunction_allowedFunctions (C_Compiler * /* inCompiler */
                                                       COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_stringset result_outAllowedFunctionSet ; // Returned variable
  result_outAllowedFunctionSet = GALGAS_stringset::constructor_emptySet (SOURCE_FILE_AT_LINE (30)) ;
  result_outAllowedFunctionSet.addAssign_operation (GALGAS_string ("testFunction") COMMA_SOURCE_FILE_AT_LINE (31)) ;
  result_outAllowedFunctionSet.addAssign_operation (GALGAS_string ("tasks") COMMA_SOURCE_FILE_AT_LINE (32)) ;
  result_outAllowedFunctionSet.addAssign_operation (GALGAS_string ("trueFalse") COMMA_SOURCE_FILE_AT_LINE (33)) ;
  result_outAllowedFunctionSet.addAssign_operation (GALGAS_string ("yesNo") COMMA_SOURCE_FILE_AT_LINE (34)) ;
//---
  return result_outAllowedFunctionSet ;
}



//---------------------------------------------------------------------------*
//  Function implementation                                                  *
//---------------------------------------------------------------------------*

static bool gOnceFunctionResultAvailable_allowedFunctions = false ;
static GALGAS_stringset gOnceFunctionResult_allowedFunctions ;

//---------------------------------------------------------------------------*

GALGAS_stringset function_allowedFunctions (C_Compiler * inCompiler
              COMMA_LOCATION_ARGS) {
  if (! gOnceFunctionResultAvailable_allowedFunctions) {
    gOnceFunctionResult_allowedFunctions = onceFunction_allowedFunctions (inCompiler COMMA_THERE) ;
    gOnceFunctionResultAvailable_allowedFunctions = true ;
  }
  return gOnceFunctionResult_allowedFunctions ;
}

//---------------------------------------------------------------------------*

static void releaseOnceFunctionResult_allowedFunctions (void) {
  gOnceFunctionResult_allowedFunctions.drop () ;
}

//---------------------------------------------------------------------------*

C_PrologueEpilogue gEpilogueForOnceFunction_allowedFunctions (NULL,
                                                              releaseOnceFunctionResult_allowedFunctions) ;

//---------------------------------------------------------------------------*
//  Function introspection                                                   *
//---------------------------------------------------------------------------*

static const C_galgas_type_descriptor * functionArgs_allowedFunctions [1] = {
  NULL
} ;

//---------------------------------------------------------------------------*

static GALGAS_object functionWithGenericHeader_allowedFunctions (C_Compiler * inCompiler,
                                                                 const cObjectArray & /* inEffectiveParameterArray */,
                                                                 const GALGAS_location & /* inErrorLocation */
                                                                 COMMA_LOCATION_ARGS) {
  return function_allowedFunctions (inCompiler COMMA_THERE).reader_object (THERE) ;
}

//---------------------------------------------------------------------------*

C_galgas_function_descriptor functionDescriptor_allowedFunctions ("allowedFunctions",
                                                                  functionWithGenericHeader_allowedFunctions,
                                                                  & kTypeDescriptor_GALGAS_stringset,
                                                                  0,
                                                                  functionArgs_allowedFunctions) ;

//---------------------------------------------------------------------------*
//                                                                           *
//                           Function 'fullPrefix'                           *
//                                                                           *
//---------------------------------------------------------------------------*

GALGAS_string function_fullPrefix (const GALGAS_TfieldMap & constinArgument_vars,
                                   const GALGAS_lstring & constinArgument_prefix,
                                   C_Compiler * inCompiler
                                   COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_string result_full ; // Returned variable
  GALGAS_string var_stringPrefix = constinArgument_prefix.reader_string (SOURCE_FILE_AT_LINE (43)) ;
  const enumGalgasBool test_0 = GALGAS_bool (kIsEqual, var_stringPrefix.objectCompare (GALGAS_string ("compiler"))).boolEnum () ;
  if (kBoolTrue == test_0) {
    GALGAS_Ttype var_type ;
    GALGAS_Tvalue var_value ;
    constinArgument_vars.method_searchKey (function_lstringWith (GALGAS_string ("COMPILER"), inCompiler COMMA_SOURCE_FILE_AT_LINE (47)), var_type, var_value, inCompiler COMMA_SOURCE_FILE_AT_LINE (47)) ;
    var_stringPrefix.dotAssign_operation (GALGAS_string ("/").operator_concat (var_value.reader_mStringValue (SOURCE_FILE_AT_LINE (48)) COMMA_SOURCE_FILE_AT_LINE (48)) COMMA_SOURCE_FILE_AT_LINE (48)) ;
  }else if (kBoolFalse == test_0) {
    const enumGalgasBool test_1 = GALGAS_bool (kIsEqual, var_stringPrefix.objectCompare (GALGAS_string ("linker"))).boolEnum () ;
    if (kBoolTrue == test_1) {
      GALGAS_Ttype var_type ;
      GALGAS_Tvalue var_value ;
      constinArgument_vars.method_searchKey (function_lstringWith (GALGAS_string ("LINKER"), inCompiler COMMA_SOURCE_FILE_AT_LINE (52)), var_type, var_value, inCompiler COMMA_SOURCE_FILE_AT_LINE (52)) ;
      var_stringPrefix.dotAssign_operation (GALGAS_string ("/").operator_concat (var_value.reader_mStringValue (SOURCE_FILE_AT_LINE (53)) COMMA_SOURCE_FILE_AT_LINE (53)) COMMA_SOURCE_FILE_AT_LINE (53)) ;
    }else if (kBoolFalse == test_1) {
      const enumGalgasBool test_2 = GALGAS_bool (kIsEqual, var_stringPrefix.objectCompare (GALGAS_string ("assembler"))).boolEnum () ;
      if (kBoolTrue == test_2) {
        GALGAS_Ttype var_type ;
        GALGAS_Tvalue var_value ;
        constinArgument_vars.method_searchKey (function_lstringWith (GALGAS_string ("ASSEMBLER"), inCompiler COMMA_SOURCE_FILE_AT_LINE (57)), var_type, var_value, inCompiler COMMA_SOURCE_FILE_AT_LINE (57)) ;
        var_stringPrefix.dotAssign_operation (GALGAS_string ("/").operator_concat (var_value.reader_mStringValue (SOURCE_FILE_AT_LINE (58)) COMMA_SOURCE_FILE_AT_LINE (58)) COMMA_SOURCE_FILE_AT_LINE (58)) ;
      }else if (kBoolFalse == test_2) {
        const enumGalgasBool test_3 = GALGAS_bool (kIsEqual, var_stringPrefix.objectCompare (GALGAS_string ("ROOT"))).boolEnum () ;
        if (kBoolTrue == test_3) {
          var_stringPrefix = GALGAS_string::makeEmptyString () ;
        }
      }
    }
  }
  result_full = var_stringPrefix ;
//---
  return result_full ;
}


//---------------------------------------------------------------------------*
//  Function introspection                                                   *
//---------------------------------------------------------------------------*

static const C_galgas_type_descriptor * functionArgs_fullPrefix [3] = {
  & kTypeDescriptor_GALGAS_TfieldMap,
  & kTypeDescriptor_GALGAS_lstring,
  NULL
} ;

//---------------------------------------------------------------------------*

static GALGAS_object functionWithGenericHeader_fullPrefix (C_Compiler * inCompiler,
                                                           const cObjectArray & inEffectiveParameterArray,
                                                           const GALGAS_location & /* §§ inErrorLocation */
                                                           COMMA_LOCATION_ARGS) {
  const GALGAS_TfieldMap operand0 = GALGAS_TfieldMap::extractObject (inEffectiveParameterArray.objectAtIndex (0 COMMA_HERE),
                                                                     inCompiler
                                                                     COMMA_THERE) ;
  const GALGAS_lstring operand1 = GALGAS_lstring::extractObject (inEffectiveParameterArray.objectAtIndex (1 COMMA_HERE),
                                                                 inCompiler
                                                                 COMMA_THERE) ;
  return function_fullPrefix (operand0,
                              operand1,
                              inCompiler
                              COMMA_THERE).reader_object (THERE) ;
}

//---------------------------------------------------------------------------*

C_galgas_function_descriptor functionDescriptor_fullPrefix ("fullPrefix",
                                                            functionWithGenericHeader_fullPrefix,
                                                            & kTypeDescriptor_GALGAS_string,
                                                            2,
                                                            functionArgs_fullPrefix) ;

//---------------------------------------------------------------------------*
//                                                                           *
//                      Function 'displayTypeAndValue'                       *
//                                                                           *
//---------------------------------------------------------------------------*

GALGAS_string function_displayTypeAndValue (const GALGAS_Ttype & constinArgument_inType,
                                            const GALGAS_Tvalue & constinArgument_inValue,
                                            C_Compiler * inCompiler
                                            COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_string result_outResult ; // Returned variable
  if (constinArgument_inType.isValid ()) {
    switch (constinArgument_inType.enumValue ()) {
    case GALGAS_Ttype::kNotBuilt:
      break ;
    case GALGAS_Ttype::kEnum_boolType: {
      //--- @ifExpressionForGeneration
      GALGAS_string temp_0 ;
      const enumGalgasBool test_1 = GALGAS_bool (kIsEqual, constinArgument_inValue.reader_mInt_36__34_Value (SOURCE_FILE_AT_LINE (79)).objectCompare (GALGAS_sint_36__34_ ((PMSInt64) 1LL))).boolEnum () ;
      if (kBoolTrue == test_1) {
        temp_0 = GALGAS_string ("yes") ;
      }else if (kBoolFalse == test_1) {
        temp_0 = GALGAS_string ("no") ;
      }
      result_outResult = GALGAS_string ("bool: ").operator_concat (temp_0 COMMA_SOURCE_FILE_AT_LINE (79)) ;
      } break ;
    case GALGAS_Ttype::kEnum_intType: {
      result_outResult = GALGAS_string ("unsigned: ").operator_concat (constinArgument_inValue.reader_mInt_36__34_Value (SOURCE_FILE_AT_LINE (81)).reader_string (SOURCE_FILE_AT_LINE (81)) COMMA_SOURCE_FILE_AT_LINE (81)) ;
      } break ;
    case GALGAS_Ttype::kEnum_floatType: {
      result_outResult = GALGAS_string ("float: ").operator_concat (constinArgument_inValue.reader_mFloatValue (SOURCE_FILE_AT_LINE (83)).reader_string (SOURCE_FILE_AT_LINE (83)) COMMA_SOURCE_FILE_AT_LINE (83)) ;
      } break ;
    case GALGAS_Ttype::kEnum_stringType: {
      result_outResult = GALGAS_string ("string: '").operator_concat (constinArgument_inValue.reader_mStringValue (SOURCE_FILE_AT_LINE (85)) COMMA_SOURCE_FILE_AT_LINE (85)).operator_concat (GALGAS_string ("'") COMMA_SOURCE_FILE_AT_LINE (85)) ;
      } break ;
    case GALGAS_Ttype::kEnum_listType: {
      //--- @ifExpressionForGeneration
      GALGAS_string temp_2 ;
      const enumGalgasBool test_3 = GALGAS_bool (kIsStrictSup, constinArgument_inValue.reader_mMapListValue (SOURCE_FILE_AT_LINE (87)).reader_length (SOURCE_FILE_AT_LINE (87)).objectCompare (GALGAS_uint ((PMUInt32) 1U))).boolEnum () ;
      if (kBoolTrue == test_3) {
        temp_2 = GALGAS_string ("s") ;
      }else if (kBoolFalse == test_3) {
        temp_2 = GALGAS_string::makeEmptyString () ;
      }
      result_outResult = GALGAS_string ("list, ").operator_concat (constinArgument_inValue.reader_mMapListValue (SOURCE_FILE_AT_LINE (87)).reader_length (SOURCE_FILE_AT_LINE (87)).reader_string (SOURCE_FILE_AT_LINE (87)) COMMA_SOURCE_FILE_AT_LINE (87)).operator_concat (GALGAS_string (" element") COMMA_SOURCE_FILE_AT_LINE (87)).operator_concat (temp_2 COMMA_SOURCE_FILE_AT_LINE (87)).operator_concat (GALGAS_string (":") COMMA_SOURCE_FILE_AT_LINE (87)) ;
      cEnumerator_TfieldMapList enumerator_3815 (constinArgument_inValue.reader_mMapListValue (SOURCE_FILE_AT_LINE (88)), kEnumeration_up) ;
      GALGAS_uint index_3791 ((PMUInt32) 0) ;
      while (enumerator_3815.hasCurrentObject ()) {
        result_outResult.dotAssign_operation (GALGAS_string ("\n"
          "  #").operator_concat (index_3791.reader_string (SOURCE_FILE_AT_LINE (89)) COMMA_SOURCE_FILE_AT_LINE (89)).operator_concat (GALGAS_string (":") COMMA_SOURCE_FILE_AT_LINE (89)) COMMA_SOURCE_FILE_AT_LINE (89)) ;
        cEnumerator_TfieldMap enumerator_3896 (enumerator_3815.current_mMap (HERE), kEnumeration_up) ;
        while (enumerator_3896.hasCurrentObject ()) {
          result_outResult.dotAssign_operation (GALGAS_string ("'").operator_concat (enumerator_3896.current_lkey (HERE).reader_string (SOURCE_FILE_AT_LINE (91)) COMMA_SOURCE_FILE_AT_LINE (91)).operator_concat (GALGAS_string ("' ") COMMA_SOURCE_FILE_AT_LINE (91)) COMMA_SOURCE_FILE_AT_LINE (91)) ;
          if (enumerator_3896.current_mType (HERE).isValid ()) {
            switch (enumerator_3896.current_mType (HERE).enumValue ()) {
            case GALGAS_Ttype::kNotBuilt:
              break ;
            case GALGAS_Ttype::kEnum_boolType: {
              //--- @ifExpressionForGeneration
              GALGAS_string temp_4 ;
              const enumGalgasBool test_5 = GALGAS_bool (kIsEqual, enumerator_3896.current_mValue (HERE).reader_mInt_36__34_Value (SOURCE_FILE_AT_LINE (94)).objectCompare (GALGAS_sint_36__34_ ((PMSInt64) 1LL))).boolEnum () ;
              if (kBoolTrue == test_5) {
                temp_4 = GALGAS_string ("yes") ;
              }else if (kBoolFalse == test_5) {
                temp_4 = GALGAS_string ("no") ;
              }
              result_outResult.dotAssign_operation (GALGAS_string ("bool: ").operator_concat (temp_4 COMMA_SOURCE_FILE_AT_LINE (94)) COMMA_SOURCE_FILE_AT_LINE (94)) ;
              } break ;
            case GALGAS_Ttype::kEnum_intType: {
              result_outResult.dotAssign_operation (GALGAS_string ("unsigned: ").operator_concat (enumerator_3896.current_mValue (HERE).reader_mInt_36__34_Value (SOURCE_FILE_AT_LINE (96)).reader_string (SOURCE_FILE_AT_LINE (96)) COMMA_SOURCE_FILE_AT_LINE (96)) COMMA_SOURCE_FILE_AT_LINE (96)) ;
              } break ;
            case GALGAS_Ttype::kEnum_floatType: {
              result_outResult.dotAssign_operation (GALGAS_string ("float: ").operator_concat (enumerator_3896.current_mValue (HERE).reader_mFloatValue (SOURCE_FILE_AT_LINE (98)).reader_string (SOURCE_FILE_AT_LINE (98)) COMMA_SOURCE_FILE_AT_LINE (98)) COMMA_SOURCE_FILE_AT_LINE (98)) ;
              } break ;
            case GALGAS_Ttype::kEnum_stringType: {
              result_outResult.dotAssign_operation (GALGAS_string ("string: '").operator_concat (enumerator_3896.current_mValue (HERE).reader_mStringValue (SOURCE_FILE_AT_LINE (100)) COMMA_SOURCE_FILE_AT_LINE (100)).operator_concat (GALGAS_string ("'") COMMA_SOURCE_FILE_AT_LINE (100)) COMMA_SOURCE_FILE_AT_LINE (100)) ;
              } break ;
            case GALGAS_Ttype::kEnum_listType: case GALGAS_Ttype::kEnum_structType: case GALGAS_Ttype::kEnum_mapType: {
              } break ;
            case GALGAS_Ttype::kEnum_enumType: {
              } break ;
            case GALGAS_Ttype::kEnum_unconstructedType: case GALGAS_Ttype::kEnum_functionType: {
              inCompiler->emitSemanticError (inCompiler->here (), GALGAS_string ("internal error, unconstructed type found") COMMA_SOURCE_FILE_AT_LINE (104)) ;
              } break ;
            }
          }
          if (enumerator_3896.hasNextObject ()) {
            result_outResult.dotAssign_operation (GALGAS_string (", ") COMMA_SOURCE_FILE_AT_LINE (106)) ;
          }
          enumerator_3896.gotoNextObject () ;
        }
        enumerator_3815.gotoNextObject () ;
        index_3791.increment_operation (inCompiler COMMA_SOURCE_FILE_AT_LINE (88)) ;
      }
      } break ;
    case GALGAS_Ttype::kEnum_structType: case GALGAS_Ttype::kEnum_mapType: {
      result_outResult = GALGAS_string::makeEmptyString () ;
      } break ;
    case GALGAS_Ttype::kEnum_enumType: {
      result_outResult = GALGAS_string::makeEmptyString () ;
      } break ;
    case GALGAS_Ttype::kEnum_unconstructedType: case GALGAS_Ttype::kEnum_functionType: {
      inCompiler->emitSemanticError (inCompiler->here (), GALGAS_string ("internal error, unconstructed type found") COMMA_SOURCE_FILE_AT_LINE (114)) ;
      result_outResult.drop () ; // Release error dropped variable
      } break ;
    }
  }
//---
  return result_outResult ;
}


//---------------------------------------------------------------------------*
//  Function introspection                                                   *
//---------------------------------------------------------------------------*

static const C_galgas_type_descriptor * functionArgs_displayTypeAndValue [3] = {
  & kTypeDescriptor_GALGAS_Ttype,
  & kTypeDescriptor_GALGAS_Tvalue,
  NULL
} ;

//---------------------------------------------------------------------------*

static GALGAS_object functionWithGenericHeader_displayTypeAndValue (C_Compiler * inCompiler,
                                                                    const cObjectArray & inEffectiveParameterArray,
                                                                    const GALGAS_location & /* §§ inErrorLocation */
                                                                    COMMA_LOCATION_ARGS) {
  const GALGAS_Ttype operand0 = GALGAS_Ttype::extractObject (inEffectiveParameterArray.objectAtIndex (0 COMMA_HERE),
                                                             inCompiler
                                                             COMMA_THERE) ;
  const GALGAS_Tvalue operand1 = GALGAS_Tvalue::extractObject (inEffectiveParameterArray.objectAtIndex (1 COMMA_HERE),
                                                               inCompiler
                                                               COMMA_THERE) ;
  return function_displayTypeAndValue (operand0,
                                       operand1,
                                       inCompiler
                                       COMMA_THERE).reader_object (THERE) ;
}

//---------------------------------------------------------------------------*

C_galgas_function_descriptor functionDescriptor_displayTypeAndValue ("displayTypeAndValue",
                                                                     functionWithGenericHeader_displayTypeAndValue,
                                                                     & kTypeDescriptor_GALGAS_string,
                                                                     2,
                                                                     functionArgs_displayTypeAndValue) ;

//---------------------------------------------------------------------------*
//                                                                           *
//                   Routine 'displayTemplateVariableMap'                    *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_displayTemplateVariableMap (const GALGAS_TfieldMap constinArgument_inTemplateVariableMap,
                                         C_Compiler * inCompiler
                                         COMMA_UNUSED_LOCATION_ARGS) {
  cEnumerator_TfieldMap enumerator_5036 (constinArgument_inTemplateVariableMap, kEnumeration_up) ;
  while (enumerator_5036.hasCurrentObject ()) {
    inCompiler->printMessage (GALGAS_string ("'").operator_concat (enumerator_5036.current_lkey (HERE).reader_string (SOURCE_FILE_AT_LINE (124)) COMMA_SOURCE_FILE_AT_LINE (124)).operator_concat (GALGAS_string ("' ") COMMA_SOURCE_FILE_AT_LINE (124)).operator_concat (function_displayTypeAndValue (enumerator_5036.current_mType (HERE), enumerator_5036.current_mValue (HERE), inCompiler COMMA_SOURCE_FILE_AT_LINE (124)) COMMA_SOURCE_FILE_AT_LINE (124)).operator_concat (GALGAS_string ("\n") COMMA_SOURCE_FILE_AT_LINE (124)) COMMA_SOURCE_FILE_AT_LINE (124)) ;
    enumerator_5036.gotoNextObject () ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                         Routine 'displayPathList'                         *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_displayPathList (const GALGAS_stringlist constinArgument_pathList,
                              C_Compiler * inCompiler
                              COMMA_UNUSED_LOCATION_ARGS) {
  inCompiler->printMessage (GALGAS_string (" -----------------------------------------\n") COMMA_SOURCE_FILE_AT_LINE (131)) ;
  cEnumerator_stringlist enumerator_5273 (constinArgument_pathList, kEnumeration_up) ;
  while (enumerator_5273.hasCurrentObject ()) {
    inCompiler->printMessage (GALGAS_string (" - '").operator_concat (enumerator_5273.current_mValue (HERE) COMMA_SOURCE_FILE_AT_LINE (133)).operator_concat (GALGAS_string ("'\n") COMMA_SOURCE_FILE_AT_LINE (133)) COMMA_SOURCE_FILE_AT_LINE (133)) ;
    enumerator_5273.gotoNextObject () ;
  }
  inCompiler->printMessage (GALGAS_string (" -----------------------------------------\n") COMMA_SOURCE_FILE_AT_LINE (135)) ;
}


//---------------------------------------------------------------------------*
//                                                                           *
//                       Routine 'findFileInHierarchy'                       *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_findFileInHierarchy (const GALGAS_string constinArgument_file,
                                  const GALGAS_string constinArgument_rootPath,
                                  const GALGAS_string constinArgument_searchPath,
                                  GALGAS_stringlist & ioArgument_searchedPathList,
                                  GALGAS_bool & ioArgument_found,
                                  GALGAS_string & ioArgument_fullPath,
                                  C_Compiler * inCompiler
                                  COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_string var_partialPath = constinArgument_searchPath ;
  if (constinArgument_searchPath.reader_length (SOURCE_FILE_AT_LINE (149)).isValid ()) {
    PMUInt32 variant_5687 = constinArgument_searchPath.reader_length (SOURCE_FILE_AT_LINE (149)).uintValue () ;
    bool loop_5687 = true ;
    while (loop_5687) {
      loop_5687 = GALGAS_bool (kIsStrictSup, var_partialPath.reader_length (SOURCE_FILE_AT_LINE (150)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).operator_and (ioArgument_found.operator_not (SOURCE_FILE_AT_LINE (150)) COMMA_SOURCE_FILE_AT_LINE (150)).isValid () ;
      if (loop_5687) {
        loop_5687 = GALGAS_bool (kIsStrictSup, var_partialPath.reader_length (SOURCE_FILE_AT_LINE (150)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).operator_and (ioArgument_found.operator_not (SOURCE_FILE_AT_LINE (150)) COMMA_SOURCE_FILE_AT_LINE (150)).boolValue () ;
      }
      if (loop_5687 && (0 == variant_5687)) {
        loop_5687 = false ;
        inCompiler->loopRunTimeVariantError (SOURCE_FILE_AT_LINE (149)) ;
      }
      if (loop_5687) {
        variant_5687 -- ;
        GALGAS_string var_fullFilePath = constinArgument_rootPath.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (151)).operator_concat (var_partialPath COMMA_SOURCE_FILE_AT_LINE (151)).operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (151)).operator_concat (constinArgument_file COMMA_SOURCE_FILE_AT_LINE (151)) ;
        ioArgument_searchedPathList.addAssign_operation (var_fullFilePath COMMA_SOURCE_FILE_AT_LINE (152)) ;
        ioArgument_found = var_fullFilePath.reader_fileExists (SOURCE_FILE_AT_LINE (153)) ;
        const enumGalgasBool test_0 = ioArgument_found.boolEnum () ;
        if (kBoolTrue == test_0) {
          ioArgument_fullPath = var_fullFilePath ;
        }else if (kBoolFalse == test_0) {
          var_partialPath = var_partialPath.reader_stringByDeletingLastPathComponent (SOURCE_FILE_AT_LINE (157)) ;
        }
      }
    }
  }
  const enumGalgasBool test_1 = ioArgument_found.operator_not (SOURCE_FILE_AT_LINE (160)).boolEnum () ;
  if (kBoolTrue == test_1) {
    GALGAS_string var_fullFilePath = constinArgument_rootPath.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (161)).operator_concat (constinArgument_file COMMA_SOURCE_FILE_AT_LINE (161)) ;
    ioArgument_searchedPathList.addAssign_operation (var_fullFilePath COMMA_SOURCE_FILE_AT_LINE (162)) ;
    ioArgument_found = var_fullFilePath.reader_fileExists (SOURCE_FILE_AT_LINE (163)) ;
    const enumGalgasBool test_2 = ioArgument_found.boolEnum () ;
    if (kBoolTrue == test_2) {
      ioArgument_fullPath = var_fullFilePath ;
    }
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                     Routine 'findAllFilesInHierarchy'                     *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_findAllFilesInHierarchy (const GALGAS_string constinArgument_file,
                                      const GALGAS_string constinArgument_rootPath,
                                      const GALGAS_string constinArgument_searchPath,
                                      GALGAS_stringlist & ioArgument_searchedPathList,
                                      GALGAS_stringlist & ioArgument_fullPaths,
                                      C_Compiler * inCompiler
                                      COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_string var_partialPath = constinArgument_searchPath ;
  if (constinArgument_searchPath.reader_length (SOURCE_FILE_AT_LINE (180)).isValid ()) {
    PMUInt32 variant_6589 = constinArgument_searchPath.reader_length (SOURCE_FILE_AT_LINE (180)).uintValue () ;
    bool loop_6589 = true ;
    while (loop_6589) {
      loop_6589 = GALGAS_bool (kIsStrictSup, var_partialPath.reader_length (SOURCE_FILE_AT_LINE (181)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).isValid () ;
      if (loop_6589) {
        loop_6589 = GALGAS_bool (kIsStrictSup, var_partialPath.reader_length (SOURCE_FILE_AT_LINE (181)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).boolValue () ;
      }
      if (loop_6589 && (0 == variant_6589)) {
        loop_6589 = false ;
        inCompiler->loopRunTimeVariantError (SOURCE_FILE_AT_LINE (180)) ;
      }
      if (loop_6589) {
        variant_6589 -- ;
        GALGAS_string var_fullFilePath = constinArgument_rootPath.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (182)).operator_concat (var_partialPath COMMA_SOURCE_FILE_AT_LINE (182)).operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (182)).operator_concat (constinArgument_file COMMA_SOURCE_FILE_AT_LINE (182)) ;
        ioArgument_searchedPathList.addAssign_operation (var_fullFilePath COMMA_SOURCE_FILE_AT_LINE (183)) ;
        const enumGalgasBool test_0 = var_fullFilePath.reader_fileExists (SOURCE_FILE_AT_LINE (184)).boolEnum () ;
        if (kBoolTrue == test_0) {
          ioArgument_fullPaths.addAssign_operation (var_fullFilePath COMMA_SOURCE_FILE_AT_LINE (185)) ;
        }
        GALGAS_string var_newPartialPath = var_partialPath.reader_stringByDeletingLastPathComponent (SOURCE_FILE_AT_LINE (187)) ;
        const enumGalgasBool test_1 = GALGAS_bool (kIsEqual, var_newPartialPath.objectCompare (var_partialPath)).boolEnum () ;
        if (kBoolTrue == test_1) {
          var_partialPath = GALGAS_string::makeEmptyString () ;
        }else if (kBoolFalse == test_1) {
          var_partialPath = var_newPartialPath ;
        }
      }
    }
  }
  GALGAS_string var_fullFilePath = constinArgument_rootPath.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (194)).operator_concat (constinArgument_file COMMA_SOURCE_FILE_AT_LINE (194)) ;
  ioArgument_searchedPathList.addAssign_operation (var_fullFilePath COMMA_SOURCE_FILE_AT_LINE (195)) ;
  const enumGalgasBool test_2 = var_fullFilePath.reader_fileExists (SOURCE_FILE_AT_LINE (196)).boolEnum () ;
  if (kBoolTrue == test_2) {
    ioArgument_fullPaths.addAssign_operation (var_fullFilePath COMMA_SOURCE_FILE_AT_LINE (197)) ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                       Routine 'findFileInPathList'                        *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_findFileInPathList (const GALGAS_string constinArgument_file,
                                 const GALGAS_stringlist constinArgument_rootPathList,
                                 const GALGAS_string constinArgument_searchPath,
                                 GALGAS_stringlist & outArgument_searchedPathList,
                                 GALGAS_bool & outArgument_found,
                                 GALGAS_string & outArgument_fullPath,
                                 C_Compiler * inCompiler
                                 COMMA_UNUSED_LOCATION_ARGS) {
  outArgument_searchedPathList.drop () ; // Release 'out' argument
  outArgument_found.drop () ; // Release 'out' argument
  outArgument_fullPath.drop () ; // Release 'out' argument
  outArgument_searchedPathList = GALGAS_stringlist::constructor_emptyList (SOURCE_FILE_AT_LINE (211)) ;
  outArgument_found = GALGAS_bool (false) ;
  outArgument_fullPath = GALGAS_string::makeEmptyString () ;
  cEnumerator_stringlist enumerator_7605 (constinArgument_rootPathList, kEnumeration_up) ;
  while (enumerator_7605.hasCurrentObject ()) {
    {
    routine_findFileInHierarchy (constinArgument_file, enumerator_7605.current_mValue (HERE), constinArgument_searchPath, outArgument_searchedPathList, outArgument_found, outArgument_fullPath, inCompiler COMMA_SOURCE_FILE_AT_LINE (216)) ;
    }
    enumerator_7605.gotoNextObject () ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                     Routine 'findAllFilesInPathList'                      *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_findAllFilesInPathList (const GALGAS_string constinArgument_file,
                                     const GALGAS_stringlist constinArgument_rootPathList,
                                     const GALGAS_string constinArgument_searchPath,
                                     GALGAS_stringlist & outArgument_searchedPathList,
                                     GALGAS_stringlist & outArgument_fullPaths,
                                     C_Compiler * inCompiler
                                     COMMA_UNUSED_LOCATION_ARGS) {
  outArgument_searchedPathList.drop () ; // Release 'out' argument
  outArgument_fullPaths.drop () ; // Release 'out' argument
  outArgument_searchedPathList = GALGAS_stringlist::constructor_emptyList (SOURCE_FILE_AT_LINE (236)) ;
  outArgument_fullPaths = GALGAS_stringlist::constructor_emptyList (SOURCE_FILE_AT_LINE (237)) ;
  cEnumerator_stringlist enumerator_8144 (constinArgument_rootPathList, kEnumeration_up) ;
  while (enumerator_8144.hasCurrentObject ()) {
    {
    routine_findAllFilesInHierarchy (constinArgument_file, enumerator_8144.current_mValue (HERE), constinArgument_searchPath, outArgument_searchedPathList, outArgument_fullPaths, inCompiler COMMA_SOURCE_FILE_AT_LINE (240)) ;
    }
    enumerator_8144.gotoNextObject () ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                       Routine 'templateInvocation'                        *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_templateInvocation (const GALGAS_lstring constinArgument_inTemplateName,
                                 const GALGAS_string constinArgument_inPrefix,
                                 const GALGAS_string constinArgument_inPath,
                                 const GALGAS_string constinArgument_inTemplateDirectory,
                                 const GALGAS_bool constinArgument_inErrorIfNotFound,
                                 const GALGAS_TfieldMap constinArgument_inTemplateVariableMap,
                                 GALGAS_string & ioArgument_ioResultingString,
                                 GALGAS_bool & outArgument_outNoErrorOccured,
                                 C_Compiler * inCompiler
                                 COMMA_UNUSED_LOCATION_ARGS) {
  outArgument_outNoErrorOccured.drop () ; // Release 'out' argument
  outArgument_outNoErrorOccured = GALGAS_bool (true) ;
  const enumGalgasBool test_0 = GALGAS_bool (kIsEqual, GALGAS_uint::constructor_errorCount (SOURCE_FILE_AT_LINE (263)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).boolEnum () ;
  if (kBoolTrue == test_0) {
    GALGAS_string var_templateDir = constinArgument_inTemplateDirectory ;
    const enumGalgasBool test_1 = GALGAS_bool (kIsEqual, var_templateDir.reader_length (SOURCE_FILE_AT_LINE (265)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).boolEnum () ;
    if (kBoolTrue == test_1) {
      GALGAS_location location_2 (constinArgument_inTemplateName.reader_location (HERE)) ; // Implicit use of 'location' reader
      inCompiler->emitSemanticError (location_2, GALGAS_string ("the '--goil-templates' option or the environment variable GOIL_TEMPLATES is required for generating code") COMMA_SOURCE_FILE_AT_LINE (266)) ;
    }else if (kBoolFalse == test_1) {
      const enumGalgasBool test_3 = var_templateDir.reader_directoryExists (SOURCE_FILE_AT_LINE (267)).operator_not (SOURCE_FILE_AT_LINE (267)).boolEnum () ;
      if (kBoolTrue == test_3) {
        GALGAS_location location_4 (constinArgument_inTemplateName.reader_location (HERE)) ; // Implicit use of 'location' reader
        inCompiler->emitSemanticError (location_4, GALGAS_string ("the template path '").operator_concat (var_templateDir COMMA_SOURCE_FILE_AT_LINE (268)).operator_concat (GALGAS_string ("' exists but is not a valid directory path") COMMA_SOURCE_FILE_AT_LINE (268)) COMMA_SOURCE_FILE_AT_LINE (268)) ;
      }else if (kBoolFalse == test_3) {
        GALGAS_string var_targetDir = GALGAS_string (gOption_goil_5F_options_target_5F_platform.reader_value ()) ;
        GALGAS_string var_fullTemplateDir ;
        const enumGalgasBool test_5 = GALGAS_bool (kIsEqual, constinArgument_inPrefix.objectCompare (GALGAS_string::makeEmptyString ())).boolEnum () ;
        if (kBoolTrue == test_5) {
          var_fullTemplateDir = var_templateDir ;
        }else if (kBoolFalse == test_5) {
          var_fullTemplateDir = var_templateDir.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (275)).operator_concat (constinArgument_inPrefix COMMA_SOURCE_FILE_AT_LINE (275)) ;
        }
        const enumGalgasBool test_6 = GALGAS_bool (kIsEqual, var_targetDir.reader_length (SOURCE_FILE_AT_LINE (277)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).boolEnum () ;
        if (kBoolTrue == test_6) {
          GALGAS_location location_7 (constinArgument_inTemplateName.reader_location (HERE)) ; // Implicit use of 'location' reader
          inCompiler->emitSemanticError (location_7, GALGAS_string ("the '--target' (or '-t') option is required for generating code") COMMA_SOURCE_FILE_AT_LINE (278)) ;
        }else if (kBoolFalse == test_6) {
          const enumGalgasBool test_8 = var_fullTemplateDir.reader_directoryExists (SOURCE_FILE_AT_LINE (279)).operator_not (SOURCE_FILE_AT_LINE (279)).boolEnum () ;
          if (kBoolTrue == test_8) {
            GALGAS_location location_9 (constinArgument_inTemplateName.reader_location (HERE)) ; // Implicit use of 'location' reader
            inCompiler->emitSemanticError (location_9, GALGAS_string ("internal. no '").operator_concat (var_fullTemplateDir COMMA_SOURCE_FILE_AT_LINE (280)).operator_concat (GALGAS_string ("' template found") COMMA_SOURCE_FILE_AT_LINE (280)) COMMA_SOURCE_FILE_AT_LINE (280)) ;
          }else if (kBoolFalse == test_8) {
            GALGAS_stringlist var_pathList = GALGAS_stringlist::constructor_emptyList (SOURCE_FILE_AT_LINE (287)) ;
            GALGAS_bool var_found = GALGAS_bool (false) ;
            const enumGalgasBool test_10 = GALGAS_bool (kIsNotEqual, constinArgument_inPath.objectCompare (GALGAS_string::makeEmptyString ())).boolEnum () ;
            if (kBoolTrue == test_10) {
              GALGAS_string var_userTemplateDir ;
              const enumGalgasBool test_11 = GALGAS_bool (kIsEqual, constinArgument_inPrefix.objectCompare (GALGAS_string::makeEmptyString ())).boolEnum () ;
              if (kBoolTrue == test_11) {
                var_userTemplateDir = constinArgument_inPath ;
              }else if (kBoolFalse == test_11) {
                var_userTemplateDir = constinArgument_inPath.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (294)).operator_concat (constinArgument_inPrefix COMMA_SOURCE_FILE_AT_LINE (294)) ;
              }
              GALGAS_string var_fullTemplatePath = var_userTemplateDir.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (296)).operator_concat (constinArgument_inTemplateName.reader_string (SOURCE_FILE_AT_LINE (296)) COMMA_SOURCE_FILE_AT_LINE (296)).operator_concat (GALGAS_string (".goilTemplate") COMMA_SOURCE_FILE_AT_LINE (296)) ;
              var_pathList.addAssign_operation (var_fullTemplatePath COMMA_SOURCE_FILE_AT_LINE (297)) ;
              var_found = var_fullTemplatePath.reader_fileExists (SOURCE_FILE_AT_LINE (298)) ;
              const enumGalgasBool test_12 = var_found.boolEnum () ;
              if (kBoolTrue == test_12) {
                {
                GALGAS_Tvalue joker_10725_0 ; // Joker input parameter
                GALGAS_Ttype joker_10728_0 ; // Joker input parameter
                cGrammar_template_5F_grammar::_performSourceFileParsing_ (inCompiler, GALGAS_lstring::constructor_new (var_fullTemplatePath, inCompiler->here () COMMA_SOURCE_FILE_AT_LINE (301)), constinArgument_inPrefix, constinArgument_inPath, constinArgument_inTemplateDirectory, constinArgument_inTemplateVariableMap, ioArgument_ioResultingString, joker_10725_0, joker_10728_0 COMMA_SOURCE_FILE_AT_LINE (301)) ;
                }
              }
            }
            GALGAS_string var_targetTemplatePartialPath = var_targetDir ;
            if (var_targetDir.reader_length (SOURCE_FILE_AT_LINE (305)).isValid ()) {
              PMUInt32 variant_10833 = var_targetDir.reader_length (SOURCE_FILE_AT_LINE (305)).uintValue () ;
              bool loop_10833 = true ;
              while (loop_10833) {
                loop_10833 = GALGAS_bool (kIsStrictSup, var_targetTemplatePartialPath.reader_length (SOURCE_FILE_AT_LINE (306)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).operator_and (var_found.operator_not (SOURCE_FILE_AT_LINE (306)) COMMA_SOURCE_FILE_AT_LINE (306)).isValid () ;
                if (loop_10833) {
                  loop_10833 = GALGAS_bool (kIsStrictSup, var_targetTemplatePartialPath.reader_length (SOURCE_FILE_AT_LINE (306)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).operator_and (var_found.operator_not (SOURCE_FILE_AT_LINE (306)) COMMA_SOURCE_FILE_AT_LINE (306)).boolValue () ;
                }
                if (loop_10833 && (0 == variant_10833)) {
                  loop_10833 = false ;
                  inCompiler->loopRunTimeVariantError (SOURCE_FILE_AT_LINE (305)) ;
                }
                if (loop_10833) {
                  variant_10833 -- ;
                  GALGAS_string var_fullTemplatePath = var_fullTemplateDir.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (308)).operator_concat (var_targetTemplatePartialPath COMMA_SOURCE_FILE_AT_LINE (308)).operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (308)).operator_concat (constinArgument_inTemplateName.reader_string (SOURCE_FILE_AT_LINE (308)) COMMA_SOURCE_FILE_AT_LINE (308)).operator_concat (GALGAS_string (".goilTemplate") COMMA_SOURCE_FILE_AT_LINE (308)) ;
                  var_pathList.addAssign_operation (var_fullTemplatePath COMMA_SOURCE_FILE_AT_LINE (309)) ;
                  var_found = var_fullTemplatePath.reader_fileExists (SOURCE_FILE_AT_LINE (310)) ;
                  const enumGalgasBool test_13 = var_found.boolEnum () ;
                  if (kBoolTrue == test_13) {
                    {
                    GALGAS_Tvalue joker_11386_0 ; // Joker input parameter
                    GALGAS_Ttype joker_11389_0 ; // Joker input parameter
                    cGrammar_template_5F_grammar::_performSourceFileParsing_ (inCompiler, GALGAS_lstring::constructor_new (var_fullTemplatePath, inCompiler->here () COMMA_SOURCE_FILE_AT_LINE (313)), constinArgument_inPrefix, constinArgument_inPath, constinArgument_inTemplateDirectory, constinArgument_inTemplateVariableMap, ioArgument_ioResultingString, joker_11386_0, joker_11389_0 COMMA_SOURCE_FILE_AT_LINE (313)) ;
                    }
                  }else if (kBoolFalse == test_13) {
                    var_targetTemplatePartialPath = var_targetTemplatePartialPath.reader_stringByDeletingLastPathComponent (SOURCE_FILE_AT_LINE (315)) ;
                  }
                }
              }
            }
            const enumGalgasBool test_14 = var_found.operator_not (SOURCE_FILE_AT_LINE (318)).boolEnum () ;
            if (kBoolTrue == test_14) {
              GALGAS_string var_fullTemplatePath = var_fullTemplateDir.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (319)).operator_concat (constinArgument_inTemplateName.reader_string (SOURCE_FILE_AT_LINE (319)) COMMA_SOURCE_FILE_AT_LINE (319)).operator_concat (GALGAS_string (".goilTemplate") COMMA_SOURCE_FILE_AT_LINE (319)) ;
              var_pathList.addAssign_operation (var_fullTemplatePath COMMA_SOURCE_FILE_AT_LINE (320)) ;
              var_found = var_fullTemplatePath.reader_fileExists (SOURCE_FILE_AT_LINE (321)) ;
              const enumGalgasBool test_15 = var_found.boolEnum () ;
              if (kBoolTrue == test_15) {
                {
                GALGAS_Tvalue joker_11992_0 ; // Joker input parameter
                GALGAS_Ttype joker_11995_0 ; // Joker input parameter
                cGrammar_template_5F_grammar::_performSourceFileParsing_ (inCompiler, GALGAS_lstring::constructor_new (var_fullTemplatePath, inCompiler->here () COMMA_SOURCE_FILE_AT_LINE (324)), constinArgument_inPrefix, constinArgument_inPath, constinArgument_inTemplateDirectory, constinArgument_inTemplateVariableMap, ioArgument_ioResultingString, joker_11992_0, joker_11995_0 COMMA_SOURCE_FILE_AT_LINE (324)) ;
                }
              }
            }
            const enumGalgasBool test_16 = var_found.operator_not (SOURCE_FILE_AT_LINE (327)).boolEnum () ;
            if (kBoolTrue == test_16) {
              outArgument_outNoErrorOccured = GALGAS_bool (false) ;
              const enumGalgasBool test_17 = constinArgument_inErrorIfNotFound.boolEnum () ;
              if (kBoolTrue == test_17) {
                GALGAS_string var_m = GALGAS_string ("cannot find a valid path for the '").operator_concat (constinArgument_inTemplateName.reader_string (SOURCE_FILE_AT_LINE (330)) COMMA_SOURCE_FILE_AT_LINE (330)).operator_concat (GALGAS_string ("' template; I have tried:") COMMA_SOURCE_FILE_AT_LINE (330)) ;
                cEnumerator_stringlist enumerator_12270 (var_pathList, kEnumeration_up) ;
                while (enumerator_12270.hasCurrentObject ()) {
                  var_m.dotAssign_operation (GALGAS_string ("\n"
                    "  - '").operator_concat (enumerator_12270.current_mValue (HERE) COMMA_SOURCE_FILE_AT_LINE (332)).operator_concat (GALGAS_string ("';") COMMA_SOURCE_FILE_AT_LINE (332)) COMMA_SOURCE_FILE_AT_LINE (332)) ;
                  enumerator_12270.gotoNextObject () ;
                }
                GALGAS_location location_18 (constinArgument_inTemplateName.reader_location (HERE)) ; // Implicit use of 'location' reader
                inCompiler->emitSemanticError (location_18, var_m COMMA_SOURCE_FILE_AT_LINE (334)) ;
              }
            }
          }
        }
      }
    }
  }
}


//--- START OF USER ZONE 2


//--- END OF USER ZONE 2


