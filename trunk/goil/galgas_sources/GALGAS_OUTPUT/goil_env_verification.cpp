//---------------------------------------------------------------------------*
//                                                                           *
//                     File 'goil_env_verification.cpp'                      *
//             Generated by version version GALGAS_BETA_VERSION              *
//                    november 17th, 2010, at 19h29'52"                      *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

#include "version_libpm.h"
#if CURRENT_LIBPM_VERSION != VERSION_OF_LIBPM_USED_BY_GALGAS_COMPILER
  #error "This file has been compiled with a version of GALGAS that uses libpm version VERSION_OF_LIBPM_USED_BY_GALGAS_COMPILER, different than the current version (CURRENT_LIBPM_VERSION) of libpm"
#endif

//---------------------------------------------------------------------------*

#include "goil_env_verification.h"
#include "galgas2/C_Compiler.h"
#include "galgas2/C_galgas_CLI_Options.h"

//---------------------------------------------------------------------------*

#include "goil_options.h"

//---------------------------------------------------------------------------*

#ifndef DO_NOT_GENERATE_CHECKINGS
  #define SOURCE_FILE_AT_LINE(line) "goil_env_verification.gSemantics", line
  #define COMMA_SOURCE_FILE_AT_LINE(line) , SOURCE_FILE_AT_LINE(line)
#else
  #define SOURCE_FILE_AT_LINE(line) 
  #define COMMA_SOURCE_FILE_AT_LINE(line) 
#endif

//---------------------------------------------------------------------------*
//                                                                           *
//                    Routine 'getAbsoluteSourceFilePath'                    *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_getAbsoluteSourceFilePath (const GALGAS_string constinArgument_fileName,
                                        GALGAS_string & outArgument_absoluteFilePath,
                                        C_Compiler * inCompiler
                                        COMMA_UNUSED_LOCATION_ARGS) {
  outArgument_absoluteFilePath.drop () ; // Release 'out' argument
  //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
  GALGAS_string var_sourceFilePath = GALGAS_string::constructor_stringWithSourceFilePath (inCompiler COMMA_SOURCE_FILE_AT_LINE (36)).reader_stringByDeletingLastPathComponent (SOURCE_FILE_AT_LINE (36)) ;
  //-------- @ifInstructionForGeneration
  if (GALGAS_bool (kIsEqual, var_sourceFilePath.objectCompare (GALGAS_string (""))).isValidAndTrue ()) {
    //-------- @ifInstructionForGeneration
    if (GALGAS_bool (kIsNotEqual, GALGAS_string::constructor_stringWithSourceFilePath (inCompiler COMMA_SOURCE_FILE_AT_LINE (38)).reader_firstCharacterOrNul (SOURCE_FILE_AT_LINE (38)).objectCompare (GALGAS_char (TO_UNICODE (47)))).isValidAndTrue ()) {
      //-------- @assignmentInstructionForGeneration
      var_sourceFilePath = GALGAS_string (".") ;
    }
  }
  //-------- @assignmentInstructionForGeneration
  outArgument_absoluteFilePath = constinArgument_fileName.reader_absolutePathFromPath (var_sourceFilePath COMMA_SOURCE_FILE_AT_LINE (42)) ;
}


//---------------------------------------------------------------------------*
//                                                                           *
//                         Routine 'checkFileExists'                         *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_checkFileExists (const GALGAS_lstring constinArgument_fileName,
                              C_Compiler * inCompiler
                              COMMA_UNUSED_LOCATION_ARGS) {
  //-------- @localVariableDeclarationForGeneration
  GALGAS_string var_absoluteFilePath ;
  { //-------- @routineCallInstructionForGeneration
  routine_getAbsoluteSourceFilePath (constinArgument_fileName.reader_string (SOURCE_FILE_AT_LINE (50)), var_absoluteFilePath, inCompiler COMMA_SOURCE_FILE_AT_LINE (50)) ;
  } //-------- @routineCallInstructionForGeneration
  //-------- @ifInstructionForGeneration
  if (var_absoluteFilePath.reader_fileExists (SOURCE_FILE_AT_LINE (51)).operator_not (SOURCE_FILE_AT_LINE (51)).isValidAndTrue ()) {
    //-------- @warningInstructionForGeneration
    inCompiler->emitSemanticWarning (constinArgument_fileName.reader_location (SOURCE_FILE_AT_LINE (52)), GALGAS_string ("The file '").operator_concat (var_absoluteFilePath COMMA_SOURCE_FILE_AT_LINE (52)).operator_concat (GALGAS_string ("' does not exists!") COMMA_SOURCE_FILE_AT_LINE (52)) COMMA_SOURCE_FILE_AT_LINE (52)) ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                     Routine 'checkFileDoesNotExists'                      *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_checkFileDoesNotExists (const GALGAS_lstring constinArgument_fileName,
                                     C_Compiler * inCompiler
                                     COMMA_UNUSED_LOCATION_ARGS) {
  //-------- @localVariableDeclarationForGeneration
  GALGAS_string var_absoluteFilePath ;
  { //-------- @routineCallInstructionForGeneration
  routine_getAbsoluteSourceFilePath (constinArgument_fileName.reader_string (SOURCE_FILE_AT_LINE (65)), var_absoluteFilePath, inCompiler COMMA_SOURCE_FILE_AT_LINE (65)) ;
  } //-------- @routineCallInstructionForGeneration
  //-------- @ifInstructionForGeneration
  if (constinArgument_fileName.reader_string (SOURCE_FILE_AT_LINE (66)).reader_directoryExists (SOURCE_FILE_AT_LINE (66)).isValidAndTrue ()) {
    //-------- @errorInstructionForGeneration
    inCompiler->emitSemanticError (constinArgument_fileName.reader_location (SOURCE_FILE_AT_LINE (67)), GALGAS_string ("The file '").operator_concat (var_absoluteFilePath COMMA_SOURCE_FILE_AT_LINE (67)).operator_concat (GALGAS_string ("' already exists and is a directory. It will not be overwritten.") COMMA_SOURCE_FILE_AT_LINE (67)) COMMA_SOURCE_FILE_AT_LINE (67)) ;
  }else{
    //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
    GALGAS_string var_projectDir = function_projectName (inCompiler COMMA_SOURCE_FILE_AT_LINE (72)) ;
    //-------- @assignmentInstructionForGeneration
    var_projectDir = var_projectDir.reader_absolutePathFromPath (GALGAS_string::constructor_stringWithCurrentDirectory (SOURCE_FILE_AT_LINE (73)) COMMA_SOURCE_FILE_AT_LINE (73)) ;
    //-------- @ifInstructionForGeneration
    if (GALGAS_bool (kIsEqual, var_projectDir.objectCompare (var_absoluteFilePath)).isValidAndTrue ()) {
      //-------- @errorInstructionForGeneration
      inCompiler->emitSemanticError (constinArgument_fileName.reader_location (SOURCE_FILE_AT_LINE (75)), GALGAS_string ("The file '").operator_concat (var_absoluteFilePath COMMA_SOURCE_FILE_AT_LINE (75)).operator_concat (GALGAS_string ("' is already the project directory. It will not be overwritten.") COMMA_SOURCE_FILE_AT_LINE (75)) COMMA_SOURCE_FILE_AT_LINE (75)) ;
    }
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                       Routine 'checkTrampolinePath'                       *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_checkTrampolinePath (const GALGAS_lstring constinArgument_path,
                                  C_Compiler * inCompiler
                                  COMMA_UNUSED_LOCATION_ARGS) {
  //-------- @localVariableDeclarationForGeneration
  GALGAS_string var_absolutePath ;
  { //-------- @routineCallInstructionForGeneration
  routine_getAbsoluteSourceFilePath (constinArgument_path.reader_string (SOURCE_FILE_AT_LINE (89)), var_absolutePath, inCompiler COMMA_SOURCE_FILE_AT_LINE (89)) ;
  } //-------- @routineCallInstructionForGeneration
  //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
  GALGAS_string var_osPath = var_absolutePath.operator_concat (GALGAS_string ("/os") COMMA_SOURCE_FILE_AT_LINE (91)) ;
  //-------- @ifInstructionForGeneration
  if (var_osPath.reader_directoryExists (SOURCE_FILE_AT_LINE (92)).operator_not (SOURCE_FILE_AT_LINE (92)).isValidAndTrue ()) {
    //-------- @errorInstructionForGeneration
    inCompiler->emitSemanticError (constinArgument_path.reader_location (SOURCE_FILE_AT_LINE (93)), GALGAS_string ("The directory '").operator_concat (var_absolutePath COMMA_SOURCE_FILE_AT_LINE (93)).operator_concat (GALGAS_string ("' does not seem to be the Trampoline base path.") COMMA_SOURCE_FILE_AT_LINE (93)).operator_concat (GALGAS_string (" I can't find the os/ subfolder.") COMMA_SOURCE_FILE_AT_LINE (93)) COMMA_SOURCE_FILE_AT_LINE (93)) ;
  }
  //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
  GALGAS_string var_machinesPath = var_absolutePath.operator_concat (GALGAS_string ("/machines") COMMA_SOURCE_FILE_AT_LINE (97)) ;
  //-------- @ifInstructionForGeneration
  if (var_machinesPath.reader_directoryExists (SOURCE_FILE_AT_LINE (98)).operator_not (SOURCE_FILE_AT_LINE (98)).isValidAndTrue ()) {
    //-------- @errorInstructionForGeneration
    inCompiler->emitSemanticError (constinArgument_path.reader_location (SOURCE_FILE_AT_LINE (99)), GALGAS_string ("The directory '").operator_concat (var_absolutePath COMMA_SOURCE_FILE_AT_LINE (99)).operator_concat (GALGAS_string ("' does not seem to be the Trampoline base path.") COMMA_SOURCE_FILE_AT_LINE (99)).operator_concat (GALGAS_string ("I can't find the machines/ subfolder.") COMMA_SOURCE_FILE_AT_LINE (99)) COMMA_SOURCE_FILE_AT_LINE (99)) ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                          Routine 'check_target'                           *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_check_5F_target (const GALGAS_string constinArgument_trampoline_5F_path,
                              C_Compiler * inCompiler
                              COMMA_UNUSED_LOCATION_ARGS) {
  //-------- @localVariableDeclarationForGeneration
  GALGAS_string var_machines_5F_path ;
  { //-------- @routineCallInstructionForGeneration
  routine_getAbsoluteSourceFilePath (constinArgument_trampoline_5F_path, var_machines_5F_path, inCompiler COMMA_SOURCE_FILE_AT_LINE (110)) ;
  } //-------- @routineCallInstructionForGeneration
  //-------- @appendInstructionForGeneration
  var_machines_5F_path.dotAssign_operation (GALGAS_string ("/machines") COMMA_SOURCE_FILE_AT_LINE (111)) ;
  //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
  GALGAS_string var_arch_5F_path = var_machines_5F_path.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (112)).operator_concat (function_arch (inCompiler COMMA_SOURCE_FILE_AT_LINE (112)) COMMA_SOURCE_FILE_AT_LINE (112)) ;
  //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
  GALGAS_string var_chip_5F_path = var_arch_5F_path.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (113)).operator_concat (function_chip (inCompiler COMMA_SOURCE_FILE_AT_LINE (113)) COMMA_SOURCE_FILE_AT_LINE (113)) ;
  //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
  GALGAS_string var_board_5F_path = var_chip_5F_path.operator_concat (GALGAS_string ("/") COMMA_SOURCE_FILE_AT_LINE (114)).operator_concat (function_board (inCompiler COMMA_SOURCE_FILE_AT_LINE (114)) COMMA_SOURCE_FILE_AT_LINE (114)) ;
  //-------- @ifInstructionForGeneration
  if (var_arch_5F_path.reader_directoryExists (SOURCE_FILE_AT_LINE (115)).operator_not (SOURCE_FILE_AT_LINE (115)).isValidAndTrue ()) {
    //-------- @errorInstructionForGeneration
    inCompiler->emitSemanticError (inCompiler->here (), GALGAS_string ("Architecture '").operator_concat (var_arch_5F_path COMMA_SOURCE_FILE_AT_LINE (116)).operator_concat (GALGAS_string ("' does not exist") COMMA_SOURCE_FILE_AT_LINE (116)) COMMA_SOURCE_FILE_AT_LINE (116)) ;
  }else{
    //-------- @ifInstructionForGeneration
    if (var_chip_5F_path.reader_directoryExists (SOURCE_FILE_AT_LINE (117)).operator_not (SOURCE_FILE_AT_LINE (117)).isValidAndTrue ()) {
      //-------- @errorInstructionForGeneration
      inCompiler->emitSemanticError (inCompiler->here (), GALGAS_string ("Chip '").operator_concat (var_chip_5F_path COMMA_SOURCE_FILE_AT_LINE (118)).operator_concat (GALGAS_string ("' does not exist") COMMA_SOURCE_FILE_AT_LINE (118)) COMMA_SOURCE_FILE_AT_LINE (118)) ;
    }else{
      //-------- @ifInstructionForGeneration
      if (var_board_5F_path.reader_directoryExists (SOURCE_FILE_AT_LINE (119)).operator_not (SOURCE_FILE_AT_LINE (119)).isValidAndTrue ()) {
        //-------- @errorInstructionForGeneration
        inCompiler->emitSemanticError (inCompiler->here (), GALGAS_string ("Board '").operator_concat (var_board_5F_path COMMA_SOURCE_FILE_AT_LINE (120)).operator_concat (GALGAS_string ("' does not exist") COMMA_SOURCE_FILE_AT_LINE (120)) COMMA_SOURCE_FILE_AT_LINE (120)) ;
      }
    }
  }
}


//--- START OF USER ZONE 2


//--- END OF USER ZONE 2


