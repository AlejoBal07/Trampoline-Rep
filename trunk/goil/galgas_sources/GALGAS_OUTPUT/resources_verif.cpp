//---------------------------------------------------------------------------*
//                                                                           *
//                        File 'resources_verif.cpp'                         *
//                 Generated by version GALGAS_BETA_VERSION                  *
//                      june 17th, 2010, at 18h54'31"                        *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

#include "version_libpm.h"
#if CURRENT_LIBPM_VERSION != VERSION_OF_LIBPM_USED_BY_GALGAS_COMPILER
  #error "This file has been compiled with a version of GALGAS that uses libpm version VERSION_OF_LIBPM_USED_BY_GALGAS_COMPILER, different than the current version (CURRENT_LIBPM_VERSION) of libpm"
#endif

//---------------------------------------------------------------------------*

#include "resources_verif.h"
#include "galgas-utilities/C_Compiler.h"
#include "galgas/C_galgas_CLI_Options.h"

//---------------------------------------------------------------------------*


//---------------------------------------------------------------------------*

#ifndef DO_NOT_GENERATE_CHECKINGS
  #define SOURCE_FILE_AT_LINE(line) "resources_verif.gSemantics", line
  #define COMMA_SOURCE_FILE_AT_LINE(line) , SOURCE_FILE_AT_LINE(line)
#else
  #define SOURCE_FILE_AT_LINE(line) 
  #define COMMA_SOURCE_FILE_AT_LINE(line) 
#endif

//---------------------------------------------------------------------------*
//                                                                           *
//                      Routine 'resources_well_formed'                      *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_resources_5F_well_5F_formed (GALGASap_resource_5F_map constinArgument_resources,
                                          C_Compiler * inCompiler
                                          COMMA_UNUSED_LOCATION_ARGS) {
  //-------- @foreachInstructionForGeneration
  GALGAS_resource_5F_map::cEnumerator enumerator_915 (constinArgument_resources, true) ;
  //--- simple foreach instruction
  while (enumerator_915.hasCurrentObject ()) {
    enumerator_915.updateAttributeProxies () ;
    //-------- @structuredCastInstructionForGeneration
    //--- @readerCallExpressionForGeneration
    GALGASap_resource_5F_property_5F_obj temp_0 (enumerator_915.attribute_resource.readerCall_property (SOURCE_FILE_AT_LINE (47))) ;
    if (temp_0.isValid ()) {
      if (temp_0.ptr (HERE)->typeDescriptor () == & kTypeDescriptor_GALGAS_resource_5F_property_5F_void_5F_obj) {
        //-------- @errorInstructionForGeneration
        //--- @concatExpressionForGeneration
        //--- @literalStringExpressionForGeneration
        GALGASap_string temp_1 ("RESOURCEPROPERTY attribute undefined for RESOURCE " COMMA_SOURCE_FILE_AT_LINE (49)) ;
        //--- @readerCallExpressionForGeneration
        GALGASap_string temp_2 (enumerator_915.attribute_lkey.readerCall_string (SOURCE_FILE_AT_LINE (49))) ;
        GALGASap_string temp_3 (temp_1.operator_concat (temp_2 COMMA_SOURCE_FILE_AT_LINE (49))) ;
        GALGASap_location location_4 (enumerator_915.attribute_lkey.readerCall_location (HERE)) ; // Implicit use of 'location' reader
        inCompiler->emitSemanticError (location_4, temp_3 COMMA_SOURCE_FILE_AT_LINE (49)) ;
      }
    }
    enumerator_915.next() ;
  }
}

//---------------------------------------------------------------------------*
//                                                                           *
//                    Routine 'resolve_linked_resources'                     *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_resolve_5F_linked_5F_resources (GALGASap_resource_5F_map & ioArgument_resources,
                                             C_Compiler * inCompiler
                                             COMMA_UNUSED_LOCATION_ARGS) {
  //-------- @localVariableOrConstantDeclarationWithConstructorCallForGeneration
  GALGASap_resource_5F_map var_resolved (GALGASap_resource_5F_map::constructor_emptyMap (SOURCE_FILE_AT_LINE (69))) ;
  //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
  GALGASap_resource_5F_map var_unresolved (ioArgument_resources) ;
  //-------- @localVariableOrConstantDeclarationWithConstructorCallForGeneration
  GALGASap_resource_5F_map var_unresolved_5F_next (GALGASap_resource_5F_map::constructor_emptyMap (SOURCE_FILE_AT_LINE (71))) ;
  //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
  //--- @trueExpressionForGeneration
  GALGASap_bool temp_0 (true COMMA_SOURCE_FILE_AT_LINE (72)) ;
  GALGASap_bool var_first_5F_loop (temp_0) ;
  //-------- @loopInstructionForGeneration
  //--- @addExpressionForGeneration
  //--- @subExpressionForGeneration
  //--- @readerCallExpressionForGeneration
  GALGASap_uint temp_1 (var_unresolved.readerCall_count (SOURCE_FILE_AT_LINE (74))) ;
  //--- @readerCallExpressionForGeneration
  GALGASap_uint temp_2 (var_unresolved_5F_next.readerCall_count (SOURCE_FILE_AT_LINE (74))) ;
  GALGASap_uint temp_3 (temp_1.substract_operation (temp_2, inCompiler COMMA_SOURCE_FILE_AT_LINE (74))) ;
  //--- @literalUIntExpressionForGeneration
  GALGASap_uint temp_4 ((PMUInt32) 1U COMMA_SOURCE_FILE_AT_LINE (74)) ;
  GALGASap_uint temp_5 (temp_3.add_operation (temp_4, inCompiler COMMA_SOURCE_FILE_AT_LINE (74))) ;
  if (temp_5.isValid ()) {
    PMUInt32 variant_1713 = temp_5.ptr (HERE)->uintValue () ;
    bool loop_1713 = true ;
    while (loop_1713) {
        //-------- @ifInstructionForGeneration
        if (isValidAndTrue (var_first_5F_loop)) {
          //-------- @assignmentInstructionForGeneration
          //--- @falseExpressionForGeneration
          GALGASap_bool temp_6 (false COMMA_SOURCE_FILE_AT_LINE (75)) ;
          var_first_5F_loop = temp_6 ;
        }else{
          //-------- @assignmentInstructionForGeneration
          var_unresolved = var_unresolved_5F_next ;
          //-------- @assignmentInstructionForGeneration
          GALGASap_resource_5F_map temp_7 (GALGASap_resource_5F_map::constructor_emptyMap (SOURCE_FILE_AT_LINE (78))) ;
          var_unresolved_5F_next = temp_7 ;
        }
      //--- @strictGreaterExpressionForGeneration
      //--- @readerCallExpressionForGeneration
      GALGASap_uint temp_8 (var_unresolved.readerCall_count (SOURCE_FILE_AT_LINE (80))) ;
      //--- @literalUIntExpressionForGeneration
      GALGASap_uint temp_9 ((PMUInt32) 0U COMMA_SOURCE_FILE_AT_LINE (80)) ;
      GALGASap_bool temp_10 (kIsStrictSup, GALGASap_uint::objectCompare (temp_8, temp_9) COMMA_SOURCE_FILE_AT_LINE (80)) ;
      loop_1713 = temp_10.isValid () ;
      if (loop_1713) {
        loop_1713 = temp_10.ptr (HERE)->boolValue () ;
      }
      if (loop_1713 && (0 == variant_1713)) {
        loop_1713 = false ;
        inCompiler->loopRunTimeVariantError (SOURCE_FILE_AT_LINE (74)) ;
      }
      if (loop_1713) {
        variant_1713 -- ;
        //-------- @foreachInstructionForGeneration
        GALGAS_resource_5F_map::cEnumerator enumerator_1980 (var_unresolved, true) ;
        //--- simple foreach instruction
        while (enumerator_1980.hasCurrentObject ()) {
          enumerator_1980.updateAttributeProxies () ;
          //-------- @localVariableDeclarationForGeneration
          GALGASap_resource_5F_property_5F_obj var_res_5F_prop ;
          //-------- @assignmentInstructionForGeneration
          //--- @readerCallExpressionForGeneration
          GALGASap_resource_5F_property_5F_obj temp_11 (enumerator_1980.attribute_resource.readerCall_property (SOURCE_FILE_AT_LINE (84))) ;
          var_res_5F_prop = temp_11 ;
          //-------- @structuredCastInstructionForGeneration
          if (var_res_5F_prop.isValid ()) {
            if (var_res_5F_prop.ptr (HERE)->typeDescriptor () == & kTypeDescriptor_GALGAS_resource_5F_property_5F_linked_5F_obj) {
            GALGASap_resource_5F_property_5F_linked_5F_obj cast_2237_rplo = var_res_5F_prop ;
              //-------- @ifInstructionForGeneration
              //--- @readerCallExpressionForGeneration
              //--- @readerCallExpressionForGeneration
              //--- @readerCallExpressionForGeneration
              GALGASap_lstring temp_12 (cast_2237_rplo.readerCall_linked_5F_resource (SOURCE_FILE_AT_LINE (92))) ;
              GALGASap_string temp_13 (temp_12.readerCall_string (SOURCE_FILE_AT_LINE (92))) ;
              GALGASap_bool temp_14 (var_resolved.readerCall_hasKey (temp_13 COMMA_SOURCE_FILE_AT_LINE (92))) ;
              if (isValidAndTrue (temp_14)) {
                //-------- @localVariableDeclarationForGeneration
                GALGASap_resource_5F_obj var_target_5F_resource ;
                //-------- @localVariableDeclarationForGeneration
                GALGASap_resource_5F_property_5F_obj var_target_5F_property ;
                { //-------- @methodCallInstructionForGeneration
                //--- @readerCallExpressionForGeneration
                GALGASap_lstring temp_15 (cast_2237_rplo.readerCall_linked_5F_resource (SOURCE_FILE_AT_LINE (95))) ;
                var_resolved.instanceMethodCall_get (temp_15, var_target_5F_resource, inCompiler COMMA_SOURCE_FILE_AT_LINE (95)) ;
                } //-------- END @methodCallInstructionForGeneration
                //-------- @assignmentInstructionForGeneration
                //--- @readerCallExpressionForGeneration
                GALGASap_resource_5F_property_5F_obj temp_16 (var_target_5F_resource.readerCall_property (SOURCE_FILE_AT_LINE (96))) ;
                var_target_5F_property = temp_16 ;
                //-------- @structuredCastInstructionForGeneration
                if (var_target_5F_property.isValid ()) {
                  if (var_target_5F_property.ptr (HERE)->typeDescriptor () == & kTypeDescriptor_GALGAS_resource_5F_property_5F_standard_5F_obj) {
                    { //-------- @modifierCallInstructionForGeneration
                    var_resolved.modifierCall_put (enumerator_1980.attribute_lkey, enumerator_1980.attribute_resource, inCompiler COMMA_SOURCE_FILE_AT_LINE (101)) ;
                    } //-------- END @typeMethodInstructionForGeneration
                  }else if (var_target_5F_property.ptr (HERE)->typeDescriptor () == & kTypeDescriptor_GALGAS_resource_5F_property_5F_internal_5F_obj) {
                    //-------- @errorInstructionForGeneration
                    //--- @readerCallExpressionForGeneration
                    GALGASap_location temp_17 (var_target_5F_property.readerCall_location (SOURCE_FILE_AT_LINE (105))) ;
                    //--- @concatExpressionForGeneration
                    //--- @concatExpressionForGeneration
                    //--- @concatExpressionForGeneration
                    //--- @literalStringExpressionForGeneration
                    GALGASap_string temp_18 ("RESOURCE " COMMA_SOURCE_FILE_AT_LINE (105)) ;
                    //--- @readerCallExpressionForGeneration
                    GALGASap_string temp_19 (enumerator_1980.attribute_lkey.readerCall_string (SOURCE_FILE_AT_LINE (105))) ;
                    GALGASap_string temp_20 (temp_18.operator_concat (temp_19 COMMA_SOURCE_FILE_AT_LINE (105))) ;
                    //--- @literalStringExpressionForGeneration
                    GALGASap_string temp_21 (" is linked to INTERNAL RESOURCE " COMMA_SOURCE_FILE_AT_LINE (105)) ;
                    GALGASap_string temp_22 (temp_20.operator_concat (temp_21 COMMA_SOURCE_FILE_AT_LINE (105))) ;
                    //--- @readerCallExpressionForGeneration
                    //--- @readerCallExpressionForGeneration
                    GALGASap_lstring temp_23 (cast_2237_rplo.readerCall_linked_5F_resource (SOURCE_FILE_AT_LINE (105))) ;
                    GALGASap_string temp_24 (temp_23.readerCall_string (SOURCE_FILE_AT_LINE (105))) ;
                    GALGASap_string temp_25 (temp_22.operator_concat (temp_24 COMMA_SOURCE_FILE_AT_LINE (105))) ;
                    inCompiler->emitSemanticError (temp_17, temp_25 COMMA_SOURCE_FILE_AT_LINE (105)) ;
                  }else if (var_target_5F_property.ptr (HERE)->typeDescriptor () == & kTypeDescriptor_GALGAS_resource_5F_property_5F_linked_5F_obj) {
                  GALGASap_resource_5F_property_5F_linked_5F_obj cast_3229_nrplo = var_target_5F_property ;
                    //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
                    //--- @readerCallExpressionForGeneration
                    GALGASap_location temp_26 (cast_3229_nrplo.readerCall_location (SOURCE_FILE_AT_LINE (110))) ;
                    //--- @readerCallExpressionForGeneration
                    GALGASap_lstring temp_27 (cast_3229_nrplo.readerCall_linked_5F_resource (SOURCE_FILE_AT_LINE (110))) ;
                    GALGASap_resource_5F_property_5F_linked_5F_obj temp_28 (GALGASap_resource_5F_property_5F_linked_5F_obj::constructor_new (temp_26, temp_27 COMMA_SOURCE_FILE_AT_LINE (110))) ;
                    GALGASap_resource_5F_property_5F_linked_5F_obj var_resolved_5F_prop (temp_28) ;
                    //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
                    //--- @readerCallExpressionForGeneration
                    GALGASap_lstring temp_29 (enumerator_1980.attribute_resource.readerCall_desc (SOURCE_FILE_AT_LINE (111))) ;
                    GALGASap_lstring var_resolved_5F_desc (temp_29) ;
                    //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
                    //--- @readerCallExpressionForGeneration
                    GALGASap_lstringlist temp_30 (enumerator_1980.attribute_resource.readerCall_acc_5F_apps (SOURCE_FILE_AT_LINE (112))) ;
                    GALGASap_resource_5F_obj temp_31 (GALGASap_resource_5F_obj::constructor_new (var_resolved_5F_desc, var_resolved_5F_prop, temp_30 COMMA_SOURCE_FILE_AT_LINE (112))) ;
                    GALGASap_resource_5F_obj var_resolved_5F_res (temp_31) ;
                    { //-------- @modifierCallInstructionForGeneration
                    var_resolved.modifierCall_put (enumerator_1980.attribute_lkey, var_resolved_5F_res, inCompiler COMMA_SOURCE_FILE_AT_LINE (113)) ;
                    } //-------- END @typeMethodInstructionForGeneration
                  }
                }
              }else{
                { //-------- @modifierCallInstructionForGeneration
                var_unresolved_5F_next.modifierCall_put (enumerator_1980.attribute_lkey, enumerator_1980.attribute_resource, inCompiler COMMA_SOURCE_FILE_AT_LINE (119)) ;
                } //-------- END @typeMethodInstructionForGeneration
              }
            }else{
              { //-------- @modifierCallInstructionForGeneration
              var_resolved.modifierCall_put (enumerator_1980.attribute_lkey, enumerator_1980.attribute_resource, inCompiler COMMA_SOURCE_FILE_AT_LINE (123)) ;
              } //-------- END @typeMethodInstructionForGeneration
            }
          }
          enumerator_1980.next() ;
        }
        //-------- @ifInstructionForGeneration
        //--- @equalExpressionForGeneration
        //--- @readerCallExpressionForGeneration
        GALGASap_uint temp_32 (var_unresolved.readerCall_count (SOURCE_FILE_AT_LINE (126))) ;
        //--- @readerCallExpressionForGeneration
        GALGASap_uint temp_33 (var_unresolved_5F_next.readerCall_count (SOURCE_FILE_AT_LINE (126))) ;
        GALGASap_bool temp_34 (kIsEqual, GALGASap_uint::objectCompare (temp_32, temp_33) COMMA_SOURCE_FILE_AT_LINE (126)) ;
        if (isValidAndTrue (temp_34)) {
          //-------- @errorInstructionForGeneration
          GALGASap_location temp_35 (inCompiler->here (SOURCE_FILE_AT_LINE (128))) ;
          //--- @literalStringExpressionForGeneration
          GALGASap_string temp_36 ("Cycle detected in linked resource" COMMA_SOURCE_FILE_AT_LINE (128)) ;
          inCompiler->emitSemanticError (temp_35, temp_36 COMMA_SOURCE_FILE_AT_LINE (128)) ;
          //-------- @foreachInstructionForGeneration
          GALGAS_resource_5F_map::cEnumerator enumerator_4100 (var_unresolved_5F_next, true) ;
          //--- simple foreach instruction
          while (enumerator_4100.hasCurrentObject ()) {
            enumerator_4100.updateAttributeProxies () ;
            //-------- @errorInstructionForGeneration
            //--- @literalStringExpressionForGeneration
            GALGASap_string temp_37 ("Involved in cycle" COMMA_SOURCE_FILE_AT_LINE (130)) ;
            GALGASap_location location_38 (enumerator_4100.attribute_lkey.readerCall_location (HERE)) ; // Implicit use of 'location' reader
            inCompiler->emitSemanticError (location_38, temp_37 COMMA_SOURCE_FILE_AT_LINE (130)) ;
            enumerator_4100.next() ;
          }
        }
      }
    }
  }
  //-------- @assignmentInstructionForGeneration
  ioArgument_resources = var_resolved ;
}

//--- START OF USER ZONE 2


//--- END OF USER ZONE 2


